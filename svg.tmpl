<!DOCTYPE html>
<html>
<head>
 <title>WikiLeaks Cablegate Visualisation</title>
 <link rel="stylesheet" href="svg.css" type="text/css" />
 <meta name="author" value="anonymous" />
 <meta name="description" 
  content="Graph visualisation of the WikiLeaks cables.csv reference network." />
</head>
<body>
<div id="info">
    <h1>WikiLeaks Cablegate Visualisation</h1>
    <ul>
        <li><a href="https://github.com/wlwardiary/cables2graph/">Code</a></li>
        <li><a href="https://wlwardiary.github.com/cables2graph/">Info</a></li>
        <li><a href="https://twitter.com/c2graph">Contact</a></li>
        <li><a href="https://wikileaks.org/cablegate/">WikiLeaks</a></li>
    </ul>
    <p>&copy; GPLv3 by Anonymous</p>
</div>
<div id="legend">
    <h4>Usage</h4>
    <p>Works best in a recent chromium or safari. Use browser zoom!</p>
    <h4>Legend</h4>
    <p><u>Underlined</u> <abbr title="Message Reference Number">MRN</abbr>: 
       cable not included in the cables.csv.</p> 
    <p>Node size: degree.</p>
    <p>Edge color: betweenness.</p>
    <h4>Places</h4>
    <ul>
{% for place in places %}
        <li class="{{ place }}">{{ place }}</li>
{% endfor %}
    </ul>
</div>
<div id="jump">
    <h4>Jump to MRN</h4>
    {% for v in vertices %}
      <h5><a class="{{ v.class }}" href="#{{v.label}}">{{ v.label }}</a></h5> 
      {% if v.timestamp|int > 0 %}<p class="date">{{ v.timestamp|formatts('%x') }}</p>{% endif %}
      {% if v.subject|length > 0 %}<p class="subject">{{ v.subject }}</p>{% endif %}
    {% endfor %}
    </ul>
</div>
<div id="graph">
  <svg width="{{ width }}" height="{{ height }}" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
    <filter id="dropshadow" height="130%">
      <feGaussianBlur in="SourceAlpha" stdDeviation="5"/>
        <feOffset dx="3" dy="3" result="offsetblur"/> 
        <feMerge> 
          <feMergeNode/>
          <feMergeNode in="SourceGraphic"/>
       </feMerge>
    </filter>

    <g transform="translate({{ xw }},{{ xh }}) scale(1.0)">
        <g id="edges">
        {% for e in edges %}
            <line x1="{{e.x1}}" y1="{{e.y1}}" 
                  x2="{{e.x2}}" y2="{{e.y2}}" class="btwns{{ e.betweenness|int }}"/>
        {% endfor %}
        </g>
        <g id="vertices">
            {% for v in vertices %}
            <g transform="translate({{ v.x }} {{ v.y }})" id="{{ v.label }}" 
                class="vertice {{ v.class }} degree{{ v.degree }} btwns{{v.betweenness|int }}">
                <circle cx="0" cy="0" r="{{ 10 + v.degree|int }}" />
                {% if v.timestamp|int > 0 %} 
                    <text x="0" y="{{ -10 + (v.degree|int / 2) }}" class="date">
                        {{ v.timestamp|formatts('%x') }}
                    </text>
                {% endif %}
                <text x="0" y="{{ 10 + (v.degree|int / 2) }}" class="label">
                {% if v.uri %} 
                    <a xlink:href="{{v.uri}}">{{ v.label }}</a>
                {% else %}
                    {{ v.label }}
                {% endif %}
                </text>
                {% if v.subject|length > 0 %}
                    <g class="subject"> 
                      <text x="-200" y="{{ 35 + (v.degree|int / 2) }}">
                        <tspan>{{ v.subject }}</tspan>
                      </text>
                    </g>
                {% endif %}
                {% if v.sentences %}
                    <g class="sentence"> 
                    {% for s in v.sentences %}
                    <text x="-200" y="{{ 30 + loop.index * 20 }}">
                        <tspan class="a1">{{ s.a1 }}</tspan>
                        <tspan class="rel">{{ s.rel }}</tspan>
                        <tspan class="a2">{{ s.a2 }}</tspan>
                    </text>
                    {% endfor %}
                    </g>
                {% endif %}
            </g>
            {% endfor %}
        </g>
    </g>
  </svg>
</div>
</body>
